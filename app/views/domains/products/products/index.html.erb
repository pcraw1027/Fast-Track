
<h3>Products</h3>

<%= form_with url: domains_products_products_path, method: :get, local: true do |form| %>
  <div class="row">

   <div class="col-md-9">
      <div class="form-group" style: "height: 40px; margin-top: 30px">
        <%= form.label :order_by, "Order By" %>
        <%= form.select :order_by,
            options_for_select(
              [
                ["Select an Option", ""],
                ["Product Name", "product_name"],
                ["Company Name", "company_name"],
                ["Product Category", "product_category"]
              ],
              params[:order_by]
            ),
            {},
            class: "form-control"
        %>
      </div>
    </div>

    <div class="col-md-3 d-flex">
      <%= form.submit "Apply sort",
            class: "btn btn-outline-success w-100",
            style: "height: 40px; margin-top: 30px" %>
    </div>


  </div>
<% end %>

<table class="table table-striped table-bordered table-hover table-sm container-fluid">
  <thead class="thead-dark">
    <tr>
      <th>Company</th>
      <th>Name</th>
      <th>Images</th>
      <th>Barcode</th>
      <th>Size</th>
      <th>Segment</th>
      <th>Family</th>
      <th>Class</th>
      <th>Brick</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @products.each do |product| %>
      <tr>
        <td><%= product.company.name if product.company %></td>
        <td><%= product.name %></td>

    <td>
   
           <% product.product_variants.each do |product_variant| %>

         
          <% product_variant.media.each do |media| %>
        
            <% if media.image? && media.file.present? %>
              <%= image_tag media.file.thumb.url, style: "width: 50px; height: 50px;" %>
            <% elsif media.video? && media.file.present? %>
              <video controls>
                <source src="<%= media.file.url %>" type="video/mp4">
              </video>
            <% elsif media.file.present? %>
              <%= link_to 'download file', media.file.url %>
            <% end %>
          
            <% end %>

     
        <% end %>

       </td>



        <td><%= product.product_variants.map(&:barcode).join(", ") %></td>
        <td><%= product.size %></td>
        <td><%= product.segment.title if product.segment%></td>
        <td><%= product.family.title if product.family %></td>
        <td><%= product.klass.title if product.klass %></td>
        <td><%= product.brick.title if product.brick %></td>
        <td><%= link_to 'View', product %></td>
        <td><%= link_to 'Edit', edit_domains_products_product_path(product) %></td>
<td><%= link_to 'Destroy', product, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>


<nav aria-label="Page navigation" class="pagination-form">
    <%= will_paginate @products, renderer: BootstrapPagination::Rails,
      class: 'pagination justify-content-center' %>

        <form method="get" action="/domains/products/products">

          <div class="form-group">
             <input name="page" class="ml-2 jumpto-field" type="number" placeholder="Page #"/>
             <input class="btn btn-outline-success" type="submit" value="Goto page" />
          </div>

        </form>
</nav>

<%= link_to 'New Product', product_capture_interface_path, class: "action-btn" %>


